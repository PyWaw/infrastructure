- hosts: pywaw.org
  remote_user: app
  vars_files:
  - ../vars/main.yml
  - ../vars/{{ settings }}.yml
  - ../vars/secret.yml
  - ../vars/secret_{{ settings }}.yml
  - ../vars/envs.yml
  tasks:
  - name: fetch and udpate repository
    git: repo={{ repository }} dest={{ repository_path }} version={{ branch }}
  - name: start containers
    docker_service:
      project_name: "{{ project }}_{{ settings }}"
      project_src: "{{ repository_path }}/containers"
      state: present
      build: yes
    environment: "{{ docker_envs }}"